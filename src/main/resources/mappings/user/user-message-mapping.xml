<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="NodeDbDAO">

	<resultMap type="com.web.bomulsum.user.message.repository.NodeDbVO" id="nodeDbVo">
		<result property="messageSeq" column="message_seq"/>
		<result property="memberCodeSeq" column="member_code_seq"/>
		<result property="writerCodeSeq" column="writer_code_seq"/>
		<result property="messageContent" column="message_content"/>
		<result property="messageTime" column="message_time"/>
		<result property="messageRead" column="message_read"/>
	</resultMap>
	
	<resultMap type="com.web.bomulsum.user.message.repository.UserChatRoomVO" id="chatVo">
		<result property="writerCode" column="writer_code_seq"/>
		<result property="writerName" column="writer_name"/>
		<result property="writerImg" column="writer_profile_img"/>
	</resultMap>
	
	<select id="getMessage" resultMap="nodeDbVo">
		SELECT * FROM message_tb
	</select>
	
	<select id="getUserCodes" resultType="String">
		SELECT member_code_seq
		FROM member_tb
	</select>
	
	<select id="getChatroom" parameterType="String" resultMap="chatVo">
		SELECT 
			writer_code_seq, writer_name, writer_profile_img
		FROM 
			writer_tb
		WHERE
			writer_code_seq 
		IN 
		(
			SELECT 
				writer_code_seq 
			FROM 
				chatroom_tb 
			WHERE 
				member_code_seq = #{userCode}
		)
	</select>
	
</mapper>
