<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="userReviewDAO">

	<resultMap type="com.web.bomulsum.user.review.repository.UserReviewVO" id="reviewListMap">
		<result column="member_name" property="memberName"/>
		<result column="member_profile" property="memberProfile"/>
		
		<result column="buy_art_code_seq" property="buyArtCodeSeq"/>
		<result column="B_ART_CODE_SEQ" property="bArtCodeSeq"/>
		<result column="B_ART_NAME" property="bArtName"/>
		<result column="B_WRITER_CODE_SEQ" property="bWriterCodeSeq"/>
		<result column="B_ART_OPTION_CATEGORY" property="bArtOptionCategory"/>
		<result column="B_ART_OPTION_NAME" property="bArtOptionName"/>
		<result column="B_ART_OPTION_PRICE" property="bArtOptionPrice"/>
		<result column="B_ART_OPTION_COUNT" property="bArtOptionCount"/>
		<result column="B_ART_REVIEW_STATUS" property="bArtReviewStatus"/>
		<result column="B_ART_REVIEW" property="bArtReview"/>
		
		<result column="art_photo" property="artPhoto"/>
		<result column="art_description" property="artDescription"/>
		
		<result column="writer_name" property="writerName"/>
		
		<result column="order_date" property="orderDate"/>
	</resultMap>

	<!-- 구매후기 쓸 수 있는 구매 상품 목록 불러오기 -->
	<select id="reviewList" parameterType="String" resultMap="reviewListMap">
		SELECT ROWNUM AS RNUM, X.*
			FROM (
				SELECT
					a.buy_art_code_seq, a.member_code_seq, a.B_ART_CODE_SEQ,
					a.B_ART_NAME, a.B_WRITER_CODE_SEQ, a.B_ART_OPTION_CATEGORY,
					a.B_ART_OPTION_NAME, a.B_ART_OPTION_PRICE, a.B_ART_OPTION_COUNT,
					a.B_ART_REVIEW_STATUS, a.B_ART_REVIEW, b.art_photo, b.art_description,
					c.writer_name, d.order_date
				FROM buy_art_tb a
				LEFT OUTER JOIN
					art_tb b ON a.b_art_code_seq = b.art_code_seq
				LEFT OUTER JOIN
					writer_tb c ON b.writer_code_seq = c.writer_code_seq
				LEFT OUTER JOIN
					order_tb d ON  a.order_code_seq = d.order_code_seq
				WHERE a.b_art_review_status = 'N' AND a.member_code_seq = #{member}
				ORDER BY d.order_date DESC
				) X
	</select>

	<!-- 구매목록 불러오기 -->
 	<!-- <select id="" parameterType="String" resultMap="">
 		SELECT * FROM buy_art_tb
 		WHERE 
 			(member_code_seq = #{memberCodeSeq})
 			AND (b_art_review = 'N')
	</select>
 -->
	<!-- 구매후기 등록하기 -->
	<!-- <insert id="" parameterType="">
	</insert> -->

</mapper>