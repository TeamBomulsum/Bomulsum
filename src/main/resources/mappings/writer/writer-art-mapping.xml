<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.web.bomulsum.writer.art.repository.WriterArtDAO">

	<resultMap id="onSaleArt" type="com.web.bomulsum.writer.art.repository.WriterArtVO">	
		<result property="artCodeSeq" column="art_code_seq"/>
		<result property="writerCodeSeq" column="writer_code_seq"/>
		<result property="artPhoto" column="art_photo"/>
		<result property="artName" column="art_name"/>
		<result property="artPrice" column="art_price"/>
		<result property="artDiscount" column="art_discount"/>
		<result property="artAmount" column="art_amount"/>
		<result property="artDescription" column="art_description"/>
		<result property="artCategory" column="art_category"/>
		<result property="artKeyword" column="art_keyword"/>
		<result property="artViewCount" column="art_viewcount"/>
		<result property="artPoint" column="art_point"/>
		<result property="artSaleCount" column="art_sale_count"/>
		<result property="artSaleState" column="art_sale_state"/>
		<result property="artRecommendTime" column="art_recommend_time"/>
		<result property="artRegisterDate" column="art_register_date"/>
	
	</resultMap>

<!-- 작품 등록 -->
	<insert id="insertArt" parameterType="com.web.bomulsum.writer.art.repository.WriterArtVO">
		INSERT INTO 
		art_tb(
			art_code_seq,
			writer_code_seq,
			art_photo,
			art_name,
			art_price,
			art_discount,
			art_amount,
			art_description,
			art_category,
			art_keyword,
			art_viewcount,
			art_point,
			art_sale_count,
			art_sale_state,
			art_recommend_time,
			art_register_date
		)
		VALUES (
			'art_code_seq' || TO_CHAR(art_code_sq.nextval),
			#{writerCodeSeq},
			#{artPhoto},
			#{artName},
			#{artPrice},
			#{artDiscount},
			#{artAmount},
			#{artDescription},
			#{artCategory},
			#{artKeyword},
			default,
			#{artPrice}*0.1,
			default,
			'Y',
			default,
			default
		)
	</insert>
  
	<select id="getArtCode" parameterType="com.web.bomulsum.writer.art.repository.WriterArtVO" resultType="String">
		SELECT art_code_seq
		FROM art_tb
		WHERE writer_code_seq=#{writerCodeSeq}
		AND art_name=#{artName}	
	</select>

	
	<insert id="insertArtInfoDetail" parameterType="com.web.bomulsum.writer.art.repository.WriterArtInfoDetailVO">
	INSERT INTO 	
		art_info_detail_tb(
			art_info_detail_code_seq,
    		art_code_seq,
   	 		art_info_detail_category,
    		art_info_detail_weight,
    		art_info_detail_from,
    		art_info_detail_material,
    		art_info_detail_expdate,
    		art_info_detail_must,
    		art_info_detail_component,
    		art_info_detail_way
		)
		VALUES (
			'art_info_detail_code_seq' || TO_CHAR(art_info_detail_code_sq.nextval),
			#{artCode},
			#{artInfoDetailCategory},
			#{artInfoDetailWeight},
			#{artInfoDetailFrom},
			#{artInfoDetailMaterial},
			#{artInfoDetailExpdate},
			#{artInfoDetailMust},
			#{artInfoDetailComponent},
			#{artInfoDetailWay}
		)
	</insert>

	<!-- 카테고리 등록 -->
	<insert id="insertArtOption1" parameterType="hashMap" >
	INSERT INTO 	
		art_option_tb(
			art_option_seq,
  			art_code_seq,
    		art_option_category,
    		art_option_name,
    		art_option_price
		)
		VALUES (
			'art_option_seq' || TO_CHAR(art_option_sq.nextval),
			#{ArtCodeSeq},
			#{OptionCategory1},
			#{optionName1},
			#{optionPrice1}
		)
	</insert>
	<insert id="insertArtOption2" parameterType="hashMap" >
	INSERT INTO 	
		art_option_tb(
			art_option_seq,
  			art_code_seq,
    		art_option_category,
    		art_option_name,
    		art_option_price
		)
		VALUES (
			'art_option_seq' || TO_CHAR(art_option_sq.nextval),
			#{ArtCodeSeq},
			#{OptionCategory1},
			#{optionName2},
			#{optionPrice2}
		)
	</insert>
	<insert id="insertArtOption3" parameterType="hashMap" >
	INSERT INTO 	
		art_option_tb(
			art_option_seq,
  			art_code_seq,
    		art_option_category,
    		art_option_name,
    		art_option_price
		)
		VALUES (
			'art_option_seq' || TO_CHAR(art_option_sq.nextval),
			#{ArtCodeSeq},
			#{OptionCategory1},
			#{optionName3},
			#{optionPrice3}
		)
	</insert>
	<insert id="insertArtOption4" parameterType="hashMap" >
	INSERT INTO 	
		art_option_tb(
			art_option_seq,
  			art_code_seq,
    		art_option_category,
    		art_option_name,
    		art_option_price
		)
		VALUES (
			'art_option_seq' || TO_CHAR(art_option_sq.nextval),
			#{ArtCodeSeq},
			#{OptionCategory2},
			#{optionName4},
			#{optionPrice4}
		)
	</insert>
	<insert id="insertArtOption5" parameterType="hashMap" >
	INSERT INTO 	
		art_option_tb(
			art_option_seq,
  			art_code_seq,
    		art_option_category,
    		art_option_name,
    		art_option_price
		)
		VALUES (
			'art_option_seq' || TO_CHAR(art_option_sq.nextval),
			#{ArtCodeSeq},
			#{OptionCategory2},
			#{optionName5},
			#{optionPrice5}
		)
	</insert>
	<insert id="insertArtOption6" parameterType="hashMap" >
	INSERT INTO 	
		art_option_tb(
			art_option_seq,
  			art_code_seq,
    		art_option_category,
    		art_option_name,
    		art_option_price
		)
		VALUES (
			'art_option_seq' || TO_CHAR(art_option_sq.nextval),
			#{ArtCodeSeq},
			#{OptionCategory2},
			#{optionName6},
			#{optionPrice6}
		)
	</insert>
	<insert id="insertArtOption7" parameterType="hashMap" >
	INSERT INTO 	
		art_option_tb(
			art_option_seq,
  			art_code_seq,
    		art_option_category,
    		art_option_name,
    		art_option_price
		)
		VALUES (
			'art_option_seq' || TO_CHAR(art_option_sq.nextval),
			#{ArtCodeSeq},
			#{OptionCategory3},
			#{optionName7},
			#{optionPrice7}
		)
	</insert>
	<insert id="insertArtOption8" parameterType="hashMap" >
	INSERT INTO 	
		art_option_tb(
			art_option_seq,
  			art_code_seq,
    		art_option_category,
    		art_option_name,
    		art_option_price
		)
		VALUES (
			'art_option_seq' || TO_CHAR(art_option_sq.nextval),
			#{ArtCodeSeq},
			#{OptionCategory3},
			#{optionName8},
			#{optionPrice8}
		)
	</insert>
	<insert id="insertArtOption9" parameterType="hashMap" >
	INSERT INTO 	
		art_option_tb(
			art_option_seq,
  			art_code_seq,
    		art_option_category,
    		art_option_name,
    		art_option_price
		)
		VALUES (
			'art_option_seq' || TO_CHAR(art_option_sq.nextval),
			#{ArtCodeSeq},
			#{OptionCategory3},
			#{optionName9},
			#{optionPrice9}
		)
	</insert>

<!-- 판매중 작품 -->

	<select id="getArtOnsale" parameterType="String" resultMap="onSaleArt">
		 SELECT * FROM art_tb 
		 WHERE writer_code_seq=#{writerCodeSeq}
		 AND art_sale_state='Y'
	</select>
 <!--   	
	<select id="getArtOnsaleBookMark" parameterType="String" resultType="java.lang.Integer">
		SELECT count(*) 
		FROM review_tb 
		WHERE review_tb.art_code_seq=#{artCodeSeq}
	</select>

	<select>
	(select count(*) from comment_tb where comment_tb.art_code_seq=#{ArtCodeSeq}),
	</select>
	
	<select

			
			(select count(*) from wishlist_tb where wishlist_tb.wishlist_option='좋아하는 작품' and wishlist_tb.wishlist_option_code=#{ArtCodeSeq}')
		FROM art_tb
		WHERE art_tb.art_code_seq=#{ArtCodeSeq};



-->
	<update id="updateSalesArt" parameterType="java.util.List">
      <foreach collection="list" item="item" separator=",">
  
         UPDATE art_tb
         SET ART_SALE_STATE='N'
         WHERE ART_CODE_SEQ=#{item.ART_CODE_SEQ}
      </foreach>
   </update>
   
   
</mapper>
